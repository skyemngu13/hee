repeat 
    wait() 
until game:IsLoaded() and game.Players.LocalPlayer and 
      game.Workspace:FindFirstChild("__Extra") and 
      game.Workspace:FindFirstChild("__Main")

local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/jensonhirst/Orion/main/source"))()

local Window = OrionLib:MakeWindow({
    Name = "P·ªãa Hub - P·ªãa x√†o me",  -- Th√™m ph·∫ßn text "P·ªãa x√†o me" ph√≠a tr∆∞·ªõc
    HidePremium = false,
    SaveConfig = false,
    ConfigFolder = "AutoHub"
})

local settingsFile = "autohub_settings.json"
local HttpService = game:GetService("HttpService")

-- ƒê·ªçc settings
local settings = {}
pcall(function()
    if isfile(settingsFile) then
        settings = HttpService:JSONDecode(readfile(settingsFile))
    end
end)

-- L∆∞u settings
local function saveSettings()
    writefile(settingsFile, HttpService:JSONEncode(settings))
end

local InfoTab = Window:MakeTab({
    Name = "Info",
    Icon = "rbxassetid://83969479610474",
    PremiumOnly = false
})

-- Th√¥ng b√°o c·∫≠p nh·∫≠t
InfoTab:AddParagraph("üõ†Ô∏è C·∫≠p nh·∫≠t m·ªõi nh·∫•t", [[
üìå - Version: v1.1
üÜï + Th√™m Auto Join Castle
üîß + C·∫£i thi·ªán hi·ªáu xu·∫•t t√≠nh nƒÉng
üí° + L∆∞u setting khi telepoint
‚öîÔ∏è + Arise ƒëang c√≥ "Jinwoo"-"Pucci"-"Denji"
‚õ©Ô∏è + Check double "b√∫ sjw N ü§ë"
üå° + Fix ping cao üóø
+++ Add auto click
]])

local MainTab = Window:MakeTab({
    Name = "Main",
    Icon = "rbxassetid://124598949660449",
    PremiumOnly = false
})

local toggleList = {
    {
        Name = "Auto Bypass",
        Key = "AutoBypass",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/bypass"
    },
    {
        Name = "Auto Kill Dungeon",
        Key = "AutoKillDungeon",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/automobdungeon"
    },
    {
        Name = "Auto Farm Mori",
        Key = "AutoFarmMori",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/mori"
    },
    {
        Name = "Auto Join Castle",  -- üëà Toggle m·ªõi
        Key = "AutoJoinCastle",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/castle"
    }
}

-- T·∫°o toggle
for _, t in ipairs(toggleList) do
    settings[t.Key] = settings[t.Key] or false

    MainTab:AddToggle({
        Name = t.Name,
        Default = settings[t.Key],
        Callback = function(val)
            settings[t.Key] = val
            saveSettings()

            if val then
                -- Ch·∫°y sau 1 frame, tr√°nh crash UI
                task.spawn(function()
                    pcall(function()
                        loadstring(game:HttpGet(t.Script))()
                    end)
                end)
            end
        end
    })
end

-- T·∫°o Tab Misc v·ªõi Toggle AutoClick (Tab n√†y s·∫Ω l√† tab th·ª© 3)
local MiscTab = Window:MakeTab({
    Name = "Misc",
    Icon = "rbxassetid://95758233681936",
    PremiumOnly = false
})

MiscTab:AddToggle({
    Name = "AutoClick",  -- Toggle m·ªõi
    Default = settings["AutoClick"] or false,
    Callback = function(val)
        settings["AutoClick"] = val
        saveSettings()

        if val then
            -- B·∫Øt ƒë·∫ßu script AutoClick khi toggle ƒë∆∞·ª£c b·∫≠t
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local Player = game:GetService("Players").LocalPlayer
            local SharedModules = ReplicatedStorage.SharedModules

            require(SharedModules.Others.GuiFunctions)
            local WeaponsModule = require(SharedModules.WeaponsModule)

            -- Ch·ªù player load xong
            repeat task.wait(1) until Player:GetAttribute("Loaded") == true

            -- N·∫øu kh√¥ng c√≥ gamepass AutoClicker th√¨ delay l√¢u h∆°n
            if Player.leaderstats:FindFirstChild("Passes") and Player.leaderstats.Passes:GetAttribute("AutoClicker") ~= true then
                task.wait(0.4)
            end

            -- N·∫øu b·ªã t·∫Øt th√¨ t·ª± b·∫≠t l·∫°i
            if Player:GetAttribute("AutoClick") ~= true then
                Player:SetAttribute("AutoClick", true)
            end

            -- G·ªçi Click
            WeaponsModule.Click({
                ["KeyCode"] = Enum.KeyCode.ButtonX
            }, false, nil, true)
        end
    end
})

-- Sau khi UI xong ‚Üí ch·∫°y c√°c script ƒë√£ b·∫≠t
task.spawn(function()
    task.wait(1) -- ƒë·∫£m b·∫£o UI v·∫Ω xong
    for _, t in ipairs(toggleList) do
        if settings[t.Key] then
            pcall(function()
                loadstring(game:HttpGet(t.Script))()
            end)
        end
    end
end)

-- B·∫≠t Anti-AFK sau khi UI kh·ªüi ƒë·ªông
task.spawn(function()
    while true do
        wait(300) -- Ch·ªù 5 ph√∫t (300 gi√¢y)
        pcall(function()
            local vu = game:GetService("VirtualUser")
            vu:CaptureController()
            vu:ClickButton2(Vector2.new())
        end)
    end
end)
