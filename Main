repeat 
    wait() 
until game:IsLoaded() and game.Players.LocalPlayer and 
      game.Workspace:FindFirstChild("__Extra") and 
      game.Workspace:FindFirstChild("__Main")

local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/jensonhirst/Orion/main/source"))()

local Window = OrionLib:MakeWindow({
    Name = "P·ªãa Hub - P·ªãa x√†o me",  -- Th√™m ph·∫ßn text "P·ªãa x√†o me" ph√≠a tr∆∞·ªõc
    HidePremium = false,
    SaveConfig = false,
    ConfigFolder = "AutoHub"
})

local settingsFile = "autohub_settings.json"
local HttpService = game:GetService("HttpService")

-- ƒê·ªçc settings
local settings = {}
pcall(function()
    if isfile(settingsFile) then
        settings = HttpService:JSONDecode(readfile(settingsFile))
    end
end)

-- L∆∞u settings
local function saveSettings()
    writefile(settingsFile, HttpService:JSONEncode(settings))
end

local InfoTab = Window:MakeTab({
    Name = "Info",
    Icon = "rbxassetid://83969479610474",
    PremiumOnly = false
})

-- Th√¥ng b√°o c·∫≠p nh·∫≠t
InfoTab:AddParagraph("üõ†Ô∏è C·∫≠p nh·∫≠t m·ªõi nh·∫•t", [[
üìå - Version: v1.1
üÜï + Th√™m Auto Join Castle
üîß + C·∫£i thi·ªán hi·ªáu xu·∫•t t√≠nh nƒÉng
üí° + L∆∞u setting khi telepoint
‚öîÔ∏è + Arise ƒëang c√≥ "Jinwoo"-"Pucci"-"Denji"
‚õ©Ô∏è + Check double "b√∫ sjw N ü§ë"
üëâ + Fast auto click(test)
üëâ + Auto load script
‚úÖÔ∏è - Anti afk ƒë√£ ƒë∆∞·ª£c b·∫≠t
üëâ + Auto Attack
üîß - fix farm mori nh∆∞ng v·∫´n d√πng tween
]])

local MainTab = Window:MakeTab({
    Name = "Main",
    Icon = "rbxassetid://124598949660449",
    PremiumOnly = false
})

local toggleList = {
    {
        Name = "Auto Bypass",
        Key = "AutoBypass",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/bypass"
    },
    {
        Name = "Auto Kill Dungeon",
        Key = "AutoKillDungeon",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/automobdungeon"
    },
    {
        Name = "Auto Farm Mori",
        Key = "AutoFarmMori",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/mori"
    },
    {
        Name = "Auto Join Castle",  -- üëà Toggle m·ªõi
        Key = "AutoJoinCastle",
        Script = "https://raw.githubusercontent.com/skyemngu13/hee/refs/heads/main/castle"
    }
}

-- T·∫°o toggle
for _, t in ipairs(toggleList) do
    settings[t.Key] = settings[t.Key] or false

    MainTab:AddToggle({
        Name = t.Name,
        Default = settings[t.Key],
        Callback = function(val)
            settings[t.Key] = val
            saveSettings()

            if val then
                -- Ch·∫°y sau 1 frame, tr√°nh crash UI
                task.spawn(function()
                    pcall(function()
                        loadstring(game:HttpGet(t.Script))()
                    end)
                end)
            end
        end
    })
end

-- T·∫°o Tab Misc v·ªõi Toggle AutoClick (Tab n√†y s·∫Ω l√† tab th·ª© 3)
local MiscTab = Window:MakeTab({
    Name = "Misc",
    Icon = "rbxassetid://95758233681936",
    PremiumOnly = false
})

local autoClicking = false  -- Bi·∫øn tr·∫°ng th√°i AutoClick

MiscTab:AddToggle({
    Name = "AutoClick",  -- Toggle m·ªõi
    Default = settings["AutoClick"] or false,
    Callback = function(val)
        settings["AutoClick"] = val
        saveSettings()

        if val then
            -- B·∫Øt ƒë·∫ßu AutoClick khi toggle b·∫≠t
            autoClicking = true
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local Player = game:GetService("Players").LocalPlayer
            local SharedModules = ReplicatedStorage.SharedModules

            require(SharedModules.Others.GuiFunctions)
            local WeaponsModule = require(SharedModules.WeaponsModule)

            -- Ch·ªù player load xong
            repeat task.wait(1) until Player:GetAttribute("Loaded") == true

            -- B·∫Øt ƒë·∫ßu v√≤ng l·∫∑p AutoClick
            task.spawn(function()
                while autoClicking do
                    task.wait(0.1)

                    -- N·∫øu kh√¥ng c√≥ gamepass AutoClicker th√¨ delay l√¢u h∆°n
                    if Player.leaderstats:FindFirstChild("Passes") and Player.leaderstats.Passes:GetAttribute("AutoClicker") ~= true then
                        task.wait(0.2)
                    end

                    -- N·∫øu b·ªã t·∫Øt th√¨ t·ª± b·∫≠t l·∫°i
                    if Player:GetAttribute("AutoClick") ~= true then
                        Player:SetAttribute("AutoClick", true)
                    end

                    -- G·ªçi Click
                    WeaponsModule.Click({
                        ["KeyCode"] = Enum.KeyCode.ButtonX
                    }, false, nil, true)
                end
            end)
        else
            -- D·ª´ng AutoClick khi toggle t·∫Øt
            autoClicking = false
        end
    end
})

MiscTab:AddToggle({
    Name = "Auto Load Script",
    Default = settings["AutoLoadScript"] or false,
    Callback = function(val)
        settings["AutoLoadScript"] = val
        saveSettings()

        if val then
            queue_on_teleport([[
                loadstring(game:HttpGet('https://raw.githubusercontent.com/Baylac2006/memaybeo/refs/heads/main/memaybeo'))()
            ]])
        end
    end
})

-- Sau khi UI xong ‚Üí ch·∫°y c√°c script ƒë√£ b·∫≠t
task.spawn(function()
    task.wait(1) -- ƒë·∫£m b·∫£o UI v·∫Ω xong
    for _, t in ipairs(toggleList) do
        if settings[t.Key] then
            pcall(function()
                loadstring(game:HttpGet(t.Script))()
            end)
        end
    end
end)

-- Th√™m Toggle cho t√≠nh nƒÉng Auto Attack
MiscTab:AddToggle({
    Name = "Auto Attack",  -- Toggle m·ªõi
    Default = settings["AutoAttack"] or false,
    Callback = function(val)
        settings["AutoAttack"] = val
        saveSettings()

        if val then
            -- B·∫Øt ƒë·∫ßu Auto Attack khi toggle b·∫≠t
            task.spawn(function()
                while settings["AutoAttack"] do
                    local closestEnemy = nil
                    local minDistance = math.huge  -- Kh·ªüi t·∫°o kho·∫£ng c√°ch t·ªëi thi·ªÉu r·∫•t l·ªõn

                    -- Ki·ªÉm tra t·∫•t c·∫£ c√°c map t·ª´ 1 ƒë·∫øn 7
                    for mapId = 1, 7 do
                        local targetMap = enemies:FindFirstChild(tostring(mapId))  -- T√¨m map theo ID
                        if targetMap then
                            -- Ki·ªÉm tra t·∫•t c·∫£ c√°c Part trong targetMap
                            for _, part in pairs(targetMap:GetChildren()) do
                                if part:IsA("Part") then
                                    -- UUID c·ªßa enemy ƒë∆∞·ª£c l∆∞u trong t√™n c·ªßa Part
                                    local enemyUUID = part.Name
                                    if enemyUUID and enemyUUID ~= "" then
                                        -- T√≠nh kho·∫£ng c√°ch gi·ªØa nh√¢n v·∫≠t v√† enemy
                                        local distance = getDistance(rootPart, part)

                                        -- N·∫øu kho·∫£ng c√°ch ng·∫Øn h∆°n, c·∫≠p nh·∫≠t k·∫ª th√π g·∫ßn nh·∫•t
                                        if distance < minDistance then
                                            closestEnemy = enemyUUID
                                            minDistance = distance
                                        end
                                    end
                                end
                            end
                        end
                    end

                    -- Ki·ªÉm tra trong __Enemies.Server (ngo√†i c√°c map)
                    for _, part in pairs(enemies:GetChildren()) do
                        if part:IsA("Part") then
                            local enemyUUID = part.Name
                            if enemyUUID and enemyUUID ~= "" then
                                -- T√≠nh kho·∫£ng c√°ch gi·ªØa nh√¢n v·∫≠t v√† enemy
                                local distance = getDistance(rootPart, part)

                                -- N·∫øu kho·∫£ng c√°ch ng·∫Øn h∆°n, c·∫≠p nh·∫≠t k·∫ª th√π g·∫ßn nh·∫•t
                                if distance < minDistance then
                                    closestEnemy = enemyUUID
                                    minDistance = distance
                                end
                            end
                        end
                    end

                    -- N·∫øu t√¨m th·∫•y k·∫ª th√π g·∫ßn nh·∫•t, t·∫•n c√¥ng
                    if closestEnemy then
                        -- G·ªçi RemoteEvent ƒë·ªÉ t·∫•n c√¥ng k·∫ª th√π g·∫ßn nh·∫•t
                        local args = {
                            [1] = {
                                [1] = {
                                    ["Event"] = "PunchAttack",
                                    ["Enemy"] = closestEnemy
                                },
                                [2] = "\4"  -- Tham s·ªë n√†y c√≥ th·ªÉ t√πy ch·ªânh theo y√™u c·∫ßu
                            }
                        }
                        -- G·ª≠i y√™u c·∫ßu t·∫•n c√¥ng
                        dataRemoteEvent:FireServer(unpack(args))
                    end

                    -- Delay ƒë·ªÉ tr√°nh g·ªçi qu√° nhanh
                    task.wait(0.4)  -- ƒêi·ªÅu ch·ªânh gi√° tr·ªã n√†y n·∫øu c·∫ßn thi·∫øt
                end
            end)
        else
            -- D·ª´ng Auto Attack khi toggle t·∫Øt
        end
    end
})

-- Anti-AFK Script (Auto Execute Version)
local vu = game:GetService("VirtualUser")
game:GetService("Players").LocalPlayer.Idled:Connect(function()
    vu:CaptureController()
    vu:ClickButton2(Vector2.new(0,0))
end)
