-- ðŸ§± Custom UI Library with MultiDropdown and Dropdown

local UILib = {}
local Players = game:GetService("Players")

local function CreateInstance(class, props)
    local inst = Instance.new(class)
    for prop, val in pairs(props) do
        inst[prop] = val
    end
    return inst
end

function UILib:CreateWindow(config)
    local gui = CreateInstance("ScreenGui", {
        Name = config.Name or "CustomUI",
        ResetOnSpawn = false,
        Parent = game:GetService("CoreGui")
    })

    local main = CreateInstance("Frame", {
        Size = UDim2.new(0, 400, 0, 300),
        Position = UDim2.new(0.5, -200, 0.5, -150),
        BackgroundColor3 = Color3.fromRGB(30, 30, 30),
        BorderSizePixel = 0,
        Parent = gui
    })

    local uiList = CreateInstance("UIListLayout", {
        Padding = UDim.new(0, 6),
        SortOrder = Enum.SortOrder.LayoutOrder,
        Parent = main
    })

    local window = {}

    function window:AddLabel(text)
        CreateInstance("TextLabel", {
            Text = text,
            Size = UDim2.new(1, -10, 0, 25),
            BackgroundTransparency = 1,
            TextColor3 = Color3.new(1, 1, 1),
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = main
        })
    end

    function window:AddDropdown(title, options, default, callback)
        local container = CreateInstance("Frame", {
            Size = UDim2.new(1, -10, 0, 30),
            BackgroundColor3 = Color3.fromRGB(40, 40, 40),
            Parent = main
        })

        local label = CreateInstance("TextLabel", {
            Text = title .. ": " .. default,
            Size = UDim2.new(1, 0, 1, 0),
            BackgroundTransparency = 1,
            TextColor3 = Color3.new(1, 1, 1),
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = container
        })

        container.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                local choice = options[math.random(1, #options)]
                label.Text = title .. ": " .. choice
                callback(choice)
            end
        end)
    end

    function window:AddMultiDropdown(title, options, defaultTable, callback)
        local selected = defaultTable or {}

        local container = CreateInstance("Frame", {
            Size = UDim2.new(1, -10, 0, #options * 20 + 10),
            BackgroundColor3 = Color3.fromRGB(40, 40, 40),
            Parent = main
        })

        CreateInstance("TextLabel", {
            Text = title,
            Size = UDim2.new(1, 0, 0, 20),
            BackgroundTransparency = 1,
            TextColor3 = Color3.new(1, 1, 1),
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = container
        })

        for i, option in ipairs(options) do
            local btn = CreateInstance("TextButton", {
                Text = option,
                Size = UDim2.new(1, 0, 0, 20),
                Position = UDim2.new(0, 0, 0, 20 * i),
                BackgroundColor3 = table.find(selected, option) and Color3.fromRGB(80, 80, 80) or Color3.fromRGB(50, 50, 50),
                TextColor3 = Color3.new(1, 1, 1),
                Parent = container
            })

            btn.MouseButton1Click:Connect(function()
                local idx = table.find(selected, option)
                if idx then
                    table.remove(selected, idx)
                    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                else
                    table.insert(selected, option)
                    btn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
                end
                callback(selected)
            end)
        end
    end

    return window
end

return UILib
