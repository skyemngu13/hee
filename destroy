local ReplicatedStorage = game:GetService("ReplicatedStorage")
local workspace = game:GetService("Workspace")

-- Lấy danh sách mob trong Server
local enemies = workspace.__Main.__Enemies.Server

-- Destroy mob
local function destroyMob(uuid)
    for i = 1, 5 do
        local args = { [1] = { [1] = { ["Event"] = "EnemyDestroy", ["Enemy"] = uuid }, [2] = "\4" } }
        ReplicatedStorage.BridgeNet2.dataRemoteEvent:FireServer(unpack(args))
        task.wait(0.2) -- Delay 0.2s giữa các lần gọi
    end
end

-- Kiểm tra tất cả các mob trong Server để thực hiện destroy
local function checkAllMobsToDestroy()
    for _, mob in pairs(enemies:GetChildren()) do
        local hp = mob:GetAttribute("HP")
        if hp and hp <= 0 then
            local uuid = mob:GetAttribute("UUID") or mob.Name
            destroyMob(uuid)
        end
    end
end

-- Main loop
while task.wait(1) do
    checkAllMobsToDestroy()
end
